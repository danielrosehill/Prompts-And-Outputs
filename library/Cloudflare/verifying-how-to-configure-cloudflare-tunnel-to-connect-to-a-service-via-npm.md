---
title: "Verifying how to configure Cloudflare Tunnel to connect to a service via NPM"
---
![GPT-4o](https://img.shields.io/badge/GPT--4o-3333FF?style=for-the-badge&logo=openai&logoColor=white)



*Note: this repository consists of the outputs of large language models (LLMs). In many cases, these are unedited or minimally edited. The information provided is for demonstrative purposes only and is intended to highlight constraints and capabilities in LLM applications and prompt engineering strategies.*


Yes, exactly! In Cloudflare, you would set the endpoint for the tunnel to **192.168.1.1**, and that will send traffic to **Nginx Proxy Manager (NPM)**, which will then map the incoming request to the appropriate internal service (like Portainer) based on the domain name.

### Here’s how the flow works:

1. **Cloudflare Tunnel**:
   - The **Cloudflare Tunnel** will forward traffic arriving for `portainer.testhomewebsite.com` to **192.168.1.1** (your server’s IP, where Nginx Proxy Manager is running).
   - In the Cloudflare DNS settings, ensure that you have a **CNAME** record for `portainer.testhomewebsite.com` that points to the Cloudflare Tunnel (not the server's IP directly).

2. **Nginx Proxy Manager**:
   - Nginx Proxy Manager is listening on **192.168.1.1**, and when it receives traffic for `portainer.testhomewebsite.com`, it will route that traffic to **192.168.1.1:9000** (Portainer’s service).
   - No need to specify ports in Cloudflare or the tunnel configuration.

### Steps for Cloudflare:

1. **Cloudflare DNS Setup**:
   - In your Cloudflare dashboard, create a **CNAME** record for `portainer.testhomewebsite.com` that points to your **Cloudflare Tunnel** (this is typically a special hostname generated by the Cloudflare Tunnel, e.g., `tunnel-id.cfargotunnel.com`).

2. **Cloudflare Tunnel Configuration**:
   - Ensure that in your Cloudflare Tunnel configuration, the **service** is defined to forward requests to **192.168.1.1** (the server running NPM). This can be set in your `config.yml` for the tunnel, or you can configure it via the Cloudflare dashboard.

Here’s a snippet of what your **Cloudflare Tunnel configuration** might look like:

```yaml
tunnel: <tunnel-id>
credentials-file: /root/.cloudflared/<tunnel-id>.json

ingress:
  - hostname: portainer.testhomewebsite.com
    service: http://192.168.1.1:80  # Send to NPM on port 80 (HTTP)
  - service: http_status:404
```

In this case, traffic for `portainer.testhomewebsite.com` is sent to **NPM** on **port 80**, and **NPM** handles forwarding it to **192.168.1.1:9000** (Portainer).

### Summary:
- **Cloudflare Tunnel** will forward traffic to **192.168.1.1**.
- **Nginx Proxy Manager** will listen on **192.168.1.1**, map the incoming request to the correct service (Portainer running on port 9000) based on the domain (`portainer.testhomewebsite.com`).
- You don't need to expose or specify ports in Cloudflare or the tunnel; NPM will handle the internal mapping for you.

Let me know if this is clear or if you need more details!