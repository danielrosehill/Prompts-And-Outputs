---
title: "Create and save output"
---
![GPT-4o](https://img.shields.io/badge/GPT--4o-3333FF?style=for-the-badge&logo=openai&logoColor=white)



*Note: this repository consists of the outputs of large language models (LLMs). In many cases, these are unedited or minimally edited. The information provided is for demonstrative purposes only and is intended to highlight constraints and capabilities in LLM applications and prompt engineering strategies.*


# Prompt

Please provide me with a guide that would allow me to achieve the following in Obsidian.

I would like to be able to click on a hotkey.

That hotkey would trigger a window to pop up within the app.

The window (modal) would have two fields:

Title (single line of text)
Prompt (paragraph of text)

The modal would have a button that says "send prompt".

When the user clicks on the "send prompt" button the following logic would occur:

1: The prompt text is copied to the /Prompts folder (as a markdown document) with the title as its file name. So if the title was LLM List a new file would be created at /Prompts/llm-list.md. 

2: A second markdown document is created in /Outputs. This document has the same filename and adheres to the following template:

```
# Prompt

(Prompt text)

# Output

(Output text)
```

The output text is generated by the OpenAI API. The user can provide the token however that would be possible. 
# Output

To achieve the functionality you described in Obsidian, you'll need to create a custom plugin. Here's a step-by-step guide to help you create this plugin:

## Setting Up the Plugin

1. Create a new folder for your plugin in the Obsidian plugins directory.
2. Initialize a new npm project and install necessary dependencies.
3. Set up the basic plugin structure.

## Creating the Modal

1. Create a new class that extends the `Modal` class from Obsidian.
2. In the `onOpen` method, create the UI elements for the title and prompt fields, and the "Send Prompt" button.

## Handling User Input

1. Add event listeners to the "Send Prompt" button.
2. When clicked, retrieve the values from the title and prompt fields.

## Creating Files

1. Use Obsidian's `vault.create` method to create the prompt file in the `/Prompts` folder.
2. Create the output file in the `/Outputs` folder using the provided template.

## Integrating with OpenAI API

1. Use the `node-fetch` library to make API calls to OpenAI.
2. Send the prompt text to the API and receive the generated output.
3. Update the output file with the received text.

Here's a basic implementation of the plugin:

```typescript
import { App, Modal, Plugin, PluginSettingTab, Setting } from 'obsidian';
import fetch from 'node-fetch';

interface PluginSettings {
    openaiApiKey: string;
}

const DEFAULT_SETTINGS: PluginSettings = {
    openaiApiKey: ''
}

export default class PromptPlugin extends Plugin {
    settings: PluginSettings;

    async onload() {
        await this.loadSettings();

        this.addCommand({
            id: 'open-prompt-modal',
            name: 'Open Prompt Modal',
            hotkeys: [{ modifiers: ["Mod"], key: "p" }],
            callback: () => {
                new PromptModal(this.app, this).open();
            }
        });

        this.addSettingTab(new PromptSettingTab(this.app, this));
    }

    async loadSettings() {
        this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    }

    async saveSettings() {
        await this.saveData(this.settings);
    }
}

class PromptModal extends Modal {
    plugin: PromptPlugin;
    titleEl: HTMLInputElement;
    promptEl: HTMLTextAreaElement;

    constructor(app: App, plugin: PromptPlugin) {
        super(app);
        this.plugin = plugin;
    }

    onOpen() {
        const {contentEl} = this;

        contentEl.createEl('h2', {text: 'Enter Prompt'});

        this.titleEl = contentEl.createEl('input', {type: 'text', placeholder: 'Title'});
        this.promptEl = contentEl.createEl('textarea', {placeholder: 'Prompt'});

        const submitBtn = contentEl.createEl('button', {text: 'Send Prompt'});
        submitBtn.addEventListener('click', this.submitPrompt.bind(this));
    }

    async submitPrompt() {
        const title = this.titleEl.value;
        const prompt = this.promptEl.value;

        // Create prompt file
        await this.app.vault.create(`Prompts/${title}.md`, prompt);

        // Generate output using OpenAI API
        const output = await this.generateOutput(prompt);

        // Create output file
        const outputContent = `# Prompt\n\n${prompt}\n\n# Output\n\n${output}`;
        await this.app.vault.create(`Outputs/${title}.md`, outputContent);

        this.close();
    }

    async generateOutput(prompt: string): Promise<string> {
        const response = await fetch('https://api.openai.com/v1/completions', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${this.plugin.settings.openaiApiKey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                model: 'text-davinci-003',
                prompt: prompt,
                max_tokens: 150
            })
        });

        const data = await response.json();
        return data.choices[0].text.trim();
    }

    onClose() {
        const {contentEl} = this;
        contentEl.empty();
    }
}

class PromptSettingTab extends PluginSettingTab {
    plugin: PromptPlugin;

    constructor(app: App, plugin: PromptPlugin) {
        super(app, plugin);
        this.plugin = plugin;
    }

    display(): void {
        const {containerEl} = this;

        containerEl.empty();

        new Setting(containerEl)
            .setName('OpenAI API Key')
            .setDesc('Enter your OpenAI API key')
            .addText(text => text
                .setPlaceholder('Enter your key')
                .setValue(this.plugin.settings.openaiApiKey)
                .onChange(async (value) => {
                    this.plugin.settings.openaiApiKey = value;
                    await this.plugin.saveSettings();
                }));
    }
}
```

This plugin creates a modal with title and prompt fields, sends the prompt to the OpenAI API, and creates the necessary files in the specified folders. The OpenAI API key is stored in the plugin settings[1][2][3][4][5][6][7][8].

Remember to handle errors, add proper input validation, and consider rate limiting for API calls. Also, ensure you're following Obsidian's plugin guidelines and best practices for security and performance.

 